<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a geeglm model using AIPW — AIPW • MIIPW</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a geeglm model using AIPW — AIPW"><meta property="og:description" content="provides augmented inverse probability weighted estimates of parameters for GEE model
of response variable using different covariance structure"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MIIPW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/miipw.html">Introduction to MIIPW</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a geeglm model using AIPW</h1>
    
    <div class="hidden name"><code>AIPW.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>provides augmented inverse probability weighted estimates of parameters for GEE model
of response variable using different covariance structure</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AIPW</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">visit</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  init.beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  init.alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  init.phi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corstr <span class="op">=</span> <span class="st">"independent"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">pMat</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>longitudinal data set where each subject's outcome has been measured at same time points and number
 of visits for each patient is similar.
Covariance structure of the outcome variable like "unstructured","independent","AR-1"
,"exchangeable"</p></dd>


<dt>formula</dt>
<dd><p>formula for the response model</p></dd>


<dt>id</dt>
<dd><p>column name of id of subjects in the dataset</p></dd>


<dt>visit</dt>
<dd><p>column name of timepoints of visit in the dataset</p></dd>


<dt>family</dt>
<dd><p>name of the distribution for the response variable, For more information on how to use <code>family</code> objects, see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code></p></dd>


<dt>init.beta</dt>
<dd><p>initial values for the regression coefficient of GEE model</p></dd>


<dt>init.alpha</dt>
<dd><p>initial values for the correlation structure</p></dd>


<dt>init.phi</dt>
<dd><p>initial values for the csale parameter for</p></dd>


<dt>tol</dt>
<dd><p>tolerance in calculation of coefficients</p></dd>


<dt>weights</dt>
<dd><p>A vector of weights for each observation.
If an observation has weight 0, it is excluded from the calculations of any parameters. Observations with a NA anywhere (even in variables not included in the model) will be assigned a weight of 0. Weights are updated as the mentioned the details.</p></dd>


<dt>corstr</dt>
<dd><p>a character string specifying the correlation structure. It could "independence", "exchangeable", "AR-1", "unstructured"</p></dd>


<dt>maxit</dt>
<dd><p>maximum number iteration for newton-raphson</p></dd>


<dt>m</dt>
<dd><p>number of imputation used to update the missing score function value due incomplete data.</p></dd>


<dt>pMat</dt>
<dd><p>predictor matrix as obtained in <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></code></p></dd>


<dt>method</dt>
<dd><p>method option for mice model,for information see <a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of objects containing the following objects</p><dl><dt>call</dt>
<dd><p>details about arguments passed in the function</p></dd>

  <dt>beta</dt>
<dd><p>estimated regression coeffictient value for the response model</p></dd>

  <dt>niter</dt>
<dd><p>number of iteration required</p></dd>

  <dt>betalist</dt>
<dd><p>list of beta values at different iteration</p></dd>

  <dt>weight</dt>
<dd><p>estimated weights for the observations</p></dd>

  <dt>mu</dt>
<dd><p>mu values according <a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></p></dd>

  <dt>phi</dt>
<dd><p>etsimated phi value for the <code>glm</code> model</p></dd>

  <dt>hessian</dt>
<dd><p>estimated hessian matrix obtained from the last iteration</p></dd>

  <dt>betaSand</dt>
<dd><p>sandwich estimator value for the variance covariance matrix of the beta</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>AIPW</p>
<p>It uses the inverse probability weighted method to reduce the bias
due to missing values in GEE model for longitudinal data. The response variable \(\mathbf{Y}\) is related to the coariates as \(g(\mu)=\mathbf{X}\beta\), where <code>g</code> is the link function for the glm. The estimating equation is
$$\sum_{i=1}^{k}\sum_{j=1}^{n}(\frac{\delta_{ij}}{\pi_{ij}}S(Y_{ij},\mathbf{X}_{ij},\mathbf{X}'_{ij})+(1-\frac{\delta_{ij}}{\pi_{ij}})\phi(\mathbf{V}=\mathbf{v}))=0$$
where \(\delta_{ij}=1\) if there is missing value in covariates and 0 otherwise,
\(\mathbf{X}\) is fully observed all subjects and \(\mathbf{X}'\) is partially missing,
 where \(\mathbf{V}=(Y,\mathbf{X})\). The missing score function values due to incomplete data are estimated
 using an imputation model through mice which we have considered as \(\phi(\mathbf{V}=\mathbf{v}))\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Wang, C. Y., Shen-Ming Lee, and Edward C. Chao. "Numerical equivalence of imputing scores and weighted estimators in regression analysis with missing covariates." Biostatistics 8.2 (2007): 468-473.</p>
<p>Seaman, Shaun R., and Stijn Vansteelandt. "Introduction to double robust methods for incomplete data." Statistical science: a review journal of the Institute of Mathematical Statistics 33.2 (2018): 184.</p>
<p>Vansteelandt, Stijn, James Carpenter, and Michael G. Kenward. "Analysis of incomplete data using inverse probability weighting and doubly robust estimators." Methodology: European Journal of Research Methods for the Behavioral and Social Sciences 6.1 (2010): 37.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="SIPW.html">SIPW</a>,<a href="miSIPW.html">miSIPW</a>,<a href="miAIPW.html">miAIPW</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra Kumar Vishwakarma</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="va">formula</span><span class="op">&lt;-</span><span class="va">C6kine</span><span class="op">~</span><span class="va">ActivinRIB</span><span class="op">+</span><span class="va">ActivinRIIA</span><span class="op">+</span><span class="va">ActivinRIIAB</span><span class="op">+</span><span class="va">Adiponectin</span><span class="op">+</span><span class="va">AgRP</span><span class="op">+</span><span class="va">ALCAM</span></span></span>
<span class="r-in"><span><span class="va">pMat</span><span class="op">&lt;-</span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/make.predictorMatrix.html" class="external-link">make.predictorMatrix</a></span><span class="op">(</span><span class="va">srdata1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">srdata1</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/allnames.html" class="external-link">all.vars</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span><span class="op">&lt;-</span><span class="fu">AIPW</span><span class="op">(</span>data<span class="op">=</span><span class="va">srdata1</span>,</span></span>
<span class="r-in"><span><span class="va">formula</span><span class="op">&lt;-</span><span class="va">formula</span>,id<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>visit<span class="op">=</span><span class="st">'Visit'</span>,family<span class="op">=</span><span class="st">'gaussian'</span>,init.beta <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>init.alpha<span class="op">=</span><span class="cn">NULL</span>,init.phi<span class="op">=</span><span class="fl">1</span>,tol<span class="op">=</span><span class="fl">.00001</span>,weights <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>corstr <span class="op">=</span> <span class="st">'exchangeable'</span>,maxit<span class="op">=</span><span class="fl">50</span>,m<span class="op">=</span><span class="fl">3</span>,pMat<span class="op">=</span><span class="va">pMat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi, Gajendra K Vishwakarma.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

